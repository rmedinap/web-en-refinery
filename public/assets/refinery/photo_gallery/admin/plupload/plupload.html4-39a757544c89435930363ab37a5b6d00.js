!function(e,t,i){function n(e){return t.getElementById(e)}i.runtimes.Html4=i.addRuntime("html4",{getFeatures:function(){return{multipart:!0,triggerDialog:i.ua.gecko&&e.FormData||i.ua.webkit}},init:function(s,a){s.bind("Init",function(a){function r(){var e,o,l,u;c=i.guid(),v.push(c),e=t.createElement("form"),e.setAttribute("id","form_"+c),e.setAttribute("method","post"),e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"),e.setAttribute("target",a.id+"_iframe"),e.style.position="absolute",o=t.createElement("input"),o.setAttribute("id","input_"+c),o.setAttribute("type","file"),o.setAttribute("accept",_),o.setAttribute("size",1),u=n(a.settings.browse_button),a.features.triggerDialog&&u&&i.addEvent(n(a.settings.browse_button),"click",function(e){o.disabled||o.click(),e.preventDefault()},a.id),i.extend(o.style,{width:"100%",height:"100%",opacity:0,fontSize:"99px",cursor:"pointer"}),i.extend(e.style,{overflow:"hidden"}),l=a.settings.shim_bgcolor,l&&(e.style.background=l),b&&i.extend(o.style,{filter:"alpha(opacity=0)"}),i.addEvent(o,"change",function(t){var l,d=t.target,h=[];d.value&&(n("form_"+c).style.top="-1048575px",l=d.value.replace(/\\/g,"/"),l=l.substring(l.length,l.lastIndexOf("/")+1),h.push(new i.File(c,l)),a.features.triggerDialog?i.removeEvent(u,"click",a.id):i.removeAllEvents(e,a.id),i.removeEvent(o,"change",a.id),r(),h.length&&s.trigger("FilesAdded",h))},a.id),e.appendChild(o),g.appendChild(e),a.refresh()}function o(){var n=t.createElement("div");n.innerHTML='<iframe id="'+a.id+'_iframe" name="'+a.id+'_iframe" src="'+m+':&quot;&quot;" style="display:none"></iframe>',l=n.firstChild,g.appendChild(l),i.addEvent(l,"load",function(t){var n,s,r=t.target;if(u){try{n=r.contentWindow.document||r.contentDocument||e.frames[r.id].document}catch(o){return a.trigger("Error",{code:i.SECURITY_ERROR,message:i.translate("Security error."),file:u}),void 0}s=n.body.innerHTML,s&&(u.status=i.DONE,u.loaded=1025,u.percent=100,a.trigger("UploadProgress",u),a.trigger("FileUploaded",u,{response:s}))}},a.id)}var l,u,c,d,h,p,f,g=t.body,m="javascript",v=[],b=/MSIE/.test(navigator.userAgent),_=[],y=a.settings.filters;e:for(d=0;d<y.length;d++)for(h=y[d].extensions.split(/,/),f=0;f<h.length;f++){if("*"===h[f]){_=[];break e}p=i.mimeTypes[h[f]],p&&-1===i.inArray(p,_)&&_.push(p)}_=_.join(","),a.settings.container&&(g=n(a.settings.container),"static"===i.getStyle(g,"position")&&(g.style.position="relative")),a.bind("UploadFile",function(e,s){var a,r;s.status!=i.DONE&&s.status!=i.FAILED&&e.state!=i.STOPPED&&(a=n("form_"+s.id),r=n("input_"+s.id),r.setAttribute("name",e.settings.file_data_name),a.setAttribute("action",e.settings.url),i.each(i.extend({name:s.target_name||s.name},e.settings.multipart_params),function(e,n){var s=t.createElement("input");i.extend(s,{type:"hidden",name:n,value:e}),a.insertBefore(s,a.firstChild)}),u=s,n("form_"+c).style.top="-1048575px",a.submit())}),a.bind("FileUploaded",function(e){e.refresh()}),a.bind("StateChanged",function(t){t.state==i.STARTED?o():t.state==i.STOPPED&&e.setTimeout(function(){i.removeEvent(l,"load",t.id),l.parentNode&&l.parentNode.removeChild(l)},0),i.each(t.files,function(e){if(e.status===i.DONE||e.status===i.FAILED){var t=n("form_"+e.id);t&&t.parentNode.removeChild(t)}})}),a.bind("Refresh",function(e){var s,a,r,o,l,u,d,h,p;s=n(e.settings.browse_button),s&&(l=i.getPos(s,n(e.settings.container)),u=i.getSize(s),d=n("form_"+c),h=n("input_"+c),i.extend(d.style,{top:l.y+"px",left:l.x+"px",width:u.w+"px",height:u.h+"px"}),e.features.triggerDialog&&("static"===i.getStyle(s,"position")&&i.extend(s.style,{position:"relative"}),p=parseInt(s.style.zIndex,10),isNaN(p)&&(p=0),i.extend(s.style,{zIndex:p}),i.extend(d.style,{zIndex:p-1})),r=e.settings.browse_button_hover,o=e.settings.browse_button_active,a=e.features.triggerDialog?s:d,r&&(i.addEvent(a,"mouseover",function(){i.addClass(s,r)},e.id),i.addEvent(a,"mouseout",function(){i.removeClass(s,r)},e.id)),o&&(i.addEvent(a,"mousedown",function(){i.addClass(s,o)},e.id),i.addEvent(t.body,"mouseup",function(){i.removeClass(s,o)},e.id)))}),s.bind("FilesRemoved",function(e,t){var i,s;for(i=0;i<t.length;i++)s=n("form_"+t[i].id),s&&s.parentNode.removeChild(s)}),s.bind("DisableBrowse",function(e,i){var n=t.getElementById("input_"+c);n&&(n.disabled=i)}),s.bind("Destroy",function(e){var s,a,r,o={inputContainer:"form_"+c,inputFile:"input_"+c,browseButton:e.settings.browse_button};for(s in o)a=n(o[s]),a&&i.removeAllEvents(a,e.id);i.removeAllEvents(t.body,e.id),i.each(v,function(e){r=n("form_"+e),r&&g.removeChild(r)})}),r()}),a({success:!0})}})}(window,document,plupload);